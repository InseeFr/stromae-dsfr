"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2699],{3828:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var t=n(4848),i=n(8453);const r={sidebar_position:2},a="Collecte",o={id:"usecases/collect",title:"Collecte",description:"La collecte des donn\xe9es est le contexte le plus important de l'application. C'est dans ce contexte que l'application est utilis\xe9e principalement, permettant d'assurer la collecte web des enqu\xeates aupr\xe8s des m\xe9nages et des entreprises de l'Insee et de ses partenaires.",source:"@site/docs/usecases/collect.md",sourceDirName:"usecases",slug:"/usecases/collect",permalink:"/stromae-dsfr/docs/usecases/collect",draft:!1,unlisted:!1,editUrl:"https://github.com/InseeFr/stromae-dsfr/tree/main/website/docs/usecases/collect.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docSidebar",previous:{title:"Conception",permalink:"/stromae-dsfr/docs/usecases/visualize"},next:{title:"Relecture",permalink:"/stromae-dsfr/docs/usecases/review"}},c={},l=[{value:"Communication avec l&#39;API",id:"communication-avec-lapi",level:2},{value:"Gestion des erreurs",id:"gestion-des-erreurs",level:2}];function u(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{id:"collecte",children:"Collecte"}),"\n",(0,t.jsx)(s.p,{children:"La collecte des donn\xe9es est le contexte le plus important de l'application. C'est dans ce contexte que l'application est utilis\xe9e principalement, permettant d'assurer la collecte web des enqu\xeates aupr\xe8s des m\xe9nages et des entreprises de l'Insee et de ses partenaires."}),"\n",(0,t.jsxs)(s.p,{children:["Ce contexte est disponible sur la route suivante : ",(0,t.jsx)(s.code,{children:"/questionnaire/$questionnaireId/unite-enquetee/$surveyUnitId"})]}),"\n",(0,t.jsx)(s.h2,{id:"communication-avec-lapi",children:"Communication avec l'API"}),"\n",(0,t.jsxs)(s.p,{children:["Les donn\xe9es n\xe9cessaires \xe0 la collecte sont directement r\xe9cup\xe9r\xe9es depuis l'API ",(0,t.jsx)(s.a,{href:"https://github.com/inseeFr/queen-back-office",children:"Queen-Back-Office"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"Pour ce faire, les endpoints suivants sont utilis\xe9s avec la m\xe9thode GET :"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Pour les questionnaires : ",(0,t.jsx)(s.code,{children:"/api/questionnaire/${questionnaireId}/data"})]}),"\n",(0,t.jsxs)(s.li,{children:["Pour les donn\xe9es : ",(0,t.jsx)(s.code,{children:"/api/survey-unit/${surveyUnitId}"})]}),"\n",(0,t.jsxs)(s.li,{children:["Pour les m\xe9tadonn\xe9es : ",(0,t.jsx)(s.code,{children:"/api/survey-unit/${surveyUnitId}/metadata"})]}),"\n",(0,t.jsxs)(s.li,{children:["Pour chaque nomenclature : ",(0,t.jsx)(s.code,{children:"/api/nomenclature/${id}"})]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Pour la persistance, nous utilisons la m\xe9thode PATCH sur l'endpoint suivant : ",(0,t.jsx)(s.code,{children:"/api/survey-unit/${surveyUnitId}"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["Les donn\xe9es persist\xe9es incluent les donn\xe9es collect\xe9es dans le questionnaire ainsi que des \xe9tats contenant la ",(0,t.jsx)(s.code,{children:"page"}),' sur laquelle l\'utilisateur se trouve, accompagn\xe9es de la date (un timestamp) et d\'un \xe9tat de la donn\xe9e, qui est "INIT" la plupart du temps sauf une fois que le questionnaire a \xe9t\xe9 valid\xe9, o\xf9 il passe \xe0 "VALIDATED".']}),"\n",(0,t.jsx)(s.p,{children:"\xc0 chaque changement de page, les nouvelles donn\xe9es accompagn\xe9es des \xe9tats associ\xe9s sont persist\xe9es."}),"\n",(0,t.jsx)(s.h2,{id:"gestion-des-erreurs",children:"Gestion des erreurs"}),"\n",(0,t.jsx)(s.p,{children:"Au chargement du questionnaire, si la communication avec l'API pour r\xe9cup\xe9rer les donn\xe9es rencontre une erreur, l'utilisateur est bloqu\xe9 sur une page d'erreur expliquant la situation et l'invitant \xe0 r\xe9essayer plus tard ou \xe0 contacter l'assistance."}),"\n",(0,t.jsx)(s.p,{children:"Ensuite, si une erreur survient lors de la persistance, un message s'affiche \xe0 l'utilisateur qui peut toutefois continuer sa saisie. Les donn\xe9es ayant \xe9t\xe9 envoy\xe9es lors des requ\xeates en erreur seront renvoy\xe9es ult\xe9rieurement (au prochain changement de page)."})]})}function d(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>o});var t=n(6540);const i={},r=t.createContext(i);function a(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);