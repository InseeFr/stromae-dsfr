/*! For license information please see navigation.module.js.LICENSE.txt */
const config={prefix:"fr",namespace:"dsfr",organisation:"@gouvfr",version:"1.12.1"},api=window[config.namespace],ITEM=api.internals.ns.selector("nav__item"),COLLAPSE=api.internals.ns.selector("collapse"),NavigationSelector={NAVIGATION:api.internals.ns.selector("nav"),COLLAPSE:`${ITEM} > ${COLLAPSE}, ${ITEM} > *:not(${ITEM}):not(${COLLAPSE}) > ${COLLAPSE}, ${ITEM} > *:not(${ITEM}):not(${COLLAPSE}) > *:not(${ITEM}):not(${COLLAPSE}) > ${COLLAPSE}`,COLLAPSE_LEGACY:`${ITEM} ${COLLAPSE}`,ITEM:ITEM,ITEM_RIGHT:`${ITEM}--align-right`,MENU:api.internals.ns.selector("menu"),BUTTON:api.internals.ns.selector("nav__btn"),TRANSLATE_BUTTON:api.internals.ns.selector("translate__btn")};class NavigationItem extends api.core.Instance{constructor(){super(),this._isRightAligned=!1}static get instanceClassName(){return"NavigationItem"}init(){this.addAscent(api.core.DisclosureEmission.ADDED,this.calculate.bind(this)),this.addAscent(api.core.DisclosureEmission.REMOVED,this.calculate.bind(this)),this.isResizing=!0,this.calculate()}resize(){this.calculate()}calculate(){const i=this.element.getDescendantInstances(api.core.Collapse.instanceClassName,null,!0)[0];if(i&&this.isBreakpoint(api.core.Breakpoints.LG)&&i.element.node.matches(NavigationSelector.MENU)){const t=this.element.node.parentElement.getBoundingClientRect().right,e=i.element.node.getBoundingClientRect().width,s=this.element.node.getBoundingClientRect().left;this.isRightAligned=s+e>t}else this.isRightAligned=!1}get isRightAligned(){return this._isRightAligned}set isRightAligned(i){this._isRightAligned!==i&&(this._isRightAligned=i,i?api.internals.dom.addClass(this.element.node,NavigationSelector.ITEM_RIGHT):api.internals.dom.removeClass(this.element.node,NavigationSelector.ITEM_RIGHT))}get collapsePrimary(){return this.element.children.map((i=>i.getInstance("CollapseButton"))).filter((i=>null!==i&&(i.hasClass(NavigationSelector.BUTTON)||i.hasClass(NavigationSelector.TRANSLATE_BUTTON))))[0]}}const NavigationMousePosition={NONE:-1,INSIDE:0,OUTSIDE:1};class Navigation extends api.core.CollapsesGroup{static get instanceClassName(){return"Navigation"}init(){super.init(),this.clicked=!1,this.out=!1,this.addEmission(api.core.RootEmission.CLICK,this._handleRootClick.bind(this)),this.listen("mousedown",this.handleMouseDown.bind(this)),this.listenClick({capture:!0}),this.isResizing=!0}validate(i){return super.validate(i)&&i.element.node.matches(api.internals.legacy.isLegacy?NavigationSelector.COLLAPSE_LEGACY:NavigationSelector.COLLAPSE)}handleMouseDown(i){this.isBreakpoint(api.core.Breakpoints.LG)&&-1!==this.index&&this.current&&(this.position=this.current.node.contains(i.target)?NavigationMousePosition.INSIDE:NavigationMousePosition.OUTSIDE,this.requestPosition())}handleClick(i){!i.target.matches("a, button")||i.target.matches("[aria-controls]")||i.target.matches(api.core.DisclosureSelector.PREVENT_CONCEAL)||(this.index=-1)}_handleRootClick(i){this.isBreakpoint(api.core.Breakpoints.LG)&&(this.node.contains(i)||(this.out=!0,this.requestPosition()))}requestPosition(){this.isRequesting||(this.isRequesting=!0,this.request(this.getPosition.bind(this)))}getPosition(){if(this.out)switch(this.position){case NavigationMousePosition.OUTSIDE:this.index=-1;break;case NavigationMousePosition.INSIDE:this.current&&!this.current.node.contains(document.activeElement)&&this.current.focus();break;default:this.index>-1&&!this.current.hasFocus&&(this.index=-1)}this.request(this.requested.bind(this))}requested(){this.position=NavigationMousePosition.NONE,this.out=!1,this.isRequesting=!1}get index(){return super.index}set index(i){-1===i&&this.current&&this.current.hasFocus&&this.current.focus(),super.index=i}get canUngroup(){return!this.isBreakpoint(api.core.Breakpoints.LG)}resize(){this.update()}}api.navigation={Navigation:Navigation,NavigationItem:NavigationItem,NavigationMousePosition:NavigationMousePosition,NavigationSelector:NavigationSelector},api.internals.register(api.navigation.NavigationSelector.NAVIGATION,api.navigation.Navigation),api.internals.register(api.navigation.NavigationSelector.ITEM,api.navigation.NavigationItem);