/*! For license information please see range.module.js.LICENSE.txt */
const config={prefix:"fr",namespace:"dsfr",organisation:"@gouvfr",version:"1.12.1"},api=window[config.namespace],RangeSelector={RANGE:api.internals.ns.selector("range"),RANGE_SM:api.internals.ns.selector("range--sm"),RANGE_STEP:api.internals.ns.selector("range--step"),RANGE_DOUBLE:api.internals.ns.selector("range--double"),RANGE_DOUBLE_STEP:api.internals.ns.selector("range--double")+api.internals.ns.selector("range--step"),RANGE_INPUT:api.internals.ns.selector("range input[type=range]:nth-of-type(1)"),RANGE_INPUT2:`${api.internals.ns.selector("range--double")} input[type=range]:nth-of-type(2)`,RANGE_OUTPUT:api.internals.ns.selector("range__output"),RANGE_MIN:api.internals.ns.selector("range__min"),RANGE_MAX:api.internals.ns.selector("range__max"),RANGE_PREFIX:api.internals.ns.attr("prefix"),RANGE_SUFFIX:api.internals.ns.attr("suffix")},RangeEmission={VALUE:api.internals.ns.emission("range","value"),VALUE2:api.internals.ns.emission("range","value2"),OUTPUT:api.internals.ns.emission("range","output"),CONSTRAINTS:api.internals.ns.emission("range","constraints"),MIN:api.internals.ns.emission("range","min"),MAX:api.internals.ns.emission("range","max"),STEP:api.internals.ns.emission("range","step"),PREFIX:api.internals.ns.emission("range","prefix"),SUFFIX:api.internals.ns.emission("range","suffix"),DISABLED:api.internals.ns.emission("range","disabled"),ENABLE_POINTER:api.internals.ns.emission("range","enable_pointer")};class RangeModel{constructor(){this._width=0,this._min=0,this._max=0,this._value=0,this._thumbSize=24,this._innerWidth=0,this._prefix="",this._suffix="",this._background={}}configure(e){e&&(this._prefix=e._prefix,this._suffix=e._suffix,this._width=e.width,this.setConstraints(e._constraints),this.value=e.value,this.update())}setPrefix(e){this._prefix=null!==e?e:""}setSuffix(e){this._suffix=null!==e?e:""}_decorate(e){return`${this._prefix}${e}${this._suffix}`}get width(){return this._width}set width(e){this._width=e}get isSm(){return this._isSm}set isSm(e){this._isSm!==e&&(this._isSm=e,this.setThumbSize(e?16:24),this.update())}setThumbSize(e,t=1){this._thumbSize=e,this._innerPadding=e*t}get textValue(){return this._decorate(this._value)}get value(){return this._value}set value(e){this._value=e}get outputX(){return this._outputX}setConstraints(e){this._constraints=e,this._min=e.min,this._max=e.max,this._step=e.step,this._rangeWidth=e.rangeWidth}get min(){return this._min}get textMin(){return this._decorate(this._min)}get max(){return this._max}get textMax(){return this._decorate(this._max)}get step(){return this._step}get output(){return{text:this.textValue,transform:`translateX(${this._translateX}px) translateX(-${this._centerPercent}%)`}}_getRatio(e){return(e-this._min)/this._rangeWidth}get progress(){return this._progress}update(){this._update()}_update(){this._innerWidth=this._width-this._innerPadding;const e=this._getRatio(this._value);this._translateX=e*this._width,this._centerPercent=100*e,this._progress={right:`${(this._innerWidth*e+.5*this._innerPadding).toFixed(2)}px`}}}class RangeModelStep extends RangeModel{get stepWidth(){return`${this._stepWidth.toFixed(3)}px`}_update(){super._update();const e=this._rangeWidth/this._step;for(this._stepWidth=this._innerWidth/e,(this._stepWidth<1||!isFinite(this._stepWidth))&&(this._stepWidth=4);this._stepWidth<4;)this._stepWidth*=2}}class RangeModelDouble extends RangeModel{get value2(){return this._value}set value2(e){this._value2!==e&&(this._value2=e,this.update())}get textValue(){return`${this._decorate(this._value)} - ${this._decorate(this._value2)}`}setThumbSize(e){super.setThumbSize(e,2)}_update(){super._update();const e=this._getRatio(.5*(this._value+this._value2));this._translateX=e*this._width,this._centerPercent=100*e;const t=this._getRatio(this._value),s=this._getRatio(this._value2);this._progress={left:`${(this._innerWidth*t+.25*this._innerPadding).toFixed(2)}px`,right:`${(this._innerWidth*s+.75*this._innerPadding).toFixed(2)}px`}}}class RangeModelDoubleStep extends RangeModelDouble{get stepWidth(){return`${this._stepWidth.toFixed(3)}px`}_update(){super._update();const e=this._rangeWidth/this._step;this._stepWidth=this._innerWidth/e,this._stepWidth<4&&(this._stepWidth*=Math.ceil(4/this._stepWidth))}}const RangeTypes={STEP:"step",DOUBLE:"double",DOUBLE_STEP:"double-step",DEFAULT:"default"};class Range extends api.core.Instance{static get instanceClassName(){return"Range"}init(){this._retrieveType(),this._retrieveSize(),this.isLegacy?(this.isResizing=!0,this.isMouseMoving=!0):(this._observer=new ResizeObserver(this.resize.bind(this)),this._observer.observe(this.node)),this.addAscent(RangeEmission.CONSTRAINTS,this.setConstraints.bind(this)),this.addAscent(RangeEmission.VALUE,this.setValue.bind(this)),this.addAscent(RangeEmission.VALUE2,this.setValue2.bind(this)),this.getAttribute(RangeSelector.RANGE_PREFIX)&&this.setPrefix(this.getAttribute(RangeSelector.RANGE_PREFIX)),this.getAttribute(RangeSelector.RANGE_SUFFIX)&&this.setSuffix(this.getAttribute(RangeSelector.RANGE_SUFFIX)),this.update()}_retrieveType(){switch(!0){case this.matches(RangeSelector.RANGE_DOUBLE_STEP):case this.matches(RangeSelector.RANGE_DOUBLE):this.type=RangeTypes.DOUBLE;break;case this.matches(RangeSelector.RANGE_STEP):this.type=RangeTypes.STEP;break;default:this.type=RangeTypes.DEFAULT}}set type(e){if(this._type===e)return;this._type=e;const t=this._model;switch(this._type){case RangeTypes.DOUBLE_STEP:this._model=new RangeModelDoubleStep;break;case RangeTypes.DOUBLE:this._model=new RangeModelDouble;break;case RangeTypes.STEP:this._model=new RangeModelStep;break;default:this._model=new RangeModel}this._model.configure(t)}get type(){return this._type}_retrieveSize(){this._model.isSm=this.matches(RangeSelector.RANGE_SM)}resize(){this._retrieveWidth(),this.update()}_retrieveWidth(){this._model.width=this.getRect().width}setValue(e){switch(this._model.value=e,this._type){case RangeTypes.DOUBLE_STEP:case RangeTypes.DOUBLE:this.descend(RangeEmission.VALUE,e)}this.update()}setValue2(e){this._model.value2=e,this.descend(RangeEmission.VALUE2,e),this.update()}setConstraints(e){this._model.setConstraints(e),this.update(),this.descend(RangeEmission.CONSTRAINTS,e)}setPrefix(e){this._model.setPrefix(e),this.update()}setSuffix(e){this._model.setSuffix(e),this.update()}mutate(e){switch(!0){case e.includes("class"):this._retrieveType(),this._retrieveSize();break;case e.includes(RangeSelector.RANGE_PREFIX):case e.includes(RangeSelector.RANGE_SUFFIX):this._model.setPrefix(this.getAttribute(RangeSelector.RANGE_PREFIX)),this._model.setSuffix(this.getAttribute(RangeSelector.RANGE_SUFFIX)),this.update()}}update(){this._model.update(),this.descend(RangeEmission.OUTPUT,this._model.output),this.descend(RangeEmission.MIN,this._model.textMin),this.descend(RangeEmission.MAX,this._model.textMax);const e=this._model.progress;e.left?this.style.setProperty("--progress-left",e.left):this.style.removeProperty("--progress-left"),e.right?(this.style.setProperty("--progress-right",e.right),this.isLegacy&&e.left&&(this.style.setProperty("background-position-x",e.left),this.style.setProperty("background-size",`${parseFloat(e.right)-parseFloat(e.left)}px ${this._model.isSm?"8px":"12px"}`))):(this.style.removeProperty("--progress-right"),this.isLegacy&&(this.style.removeProperty("background-size"),this.style.removeProperty("background-position-x"))),this._model.stepWidth?this.style.setProperty("--step-width",this._model.stepWidth):this.style.removeProperty("--step-width")}mouseMove(e){if(this._type!==RangeTypes.DOUBLE&&this._type!==RangeTypes.DOUBLE_STEP)return;const t=e.x-this.getRect().left;this.descend(RangeEmission.ENABLE_POINTER,(parseFloat(this._model.progress.right)-parseFloat(this._model.progress.left))/2+parseFloat(this._model.progress.left)<t?2:1)}dispose(){this._observer.disconnect()}}class RangeConstraints{constructor(e){this._min=isNaN(e.min)?0:e.min,this._max=isNaN(e.max)?100:e.max,this._step=isNaN(e.step)?1:e.step,this._rangeWidth=this._max-this._min}get min(){return this._min}get max(){return this._max}get step(){return this._step}get rangeWidth(){return this._rangeWidth}test(e,t,s){return this._min===e&&this._max===t&&this._step===s}}class RangeInput extends api.core.Instance{static get instanceClassName(){return"RangeInput"}init(){this._init(),this.node.value=this.getAttribute("value"),this._changing=this.change.bind(this),this._listenerType=this.isLegacy?"change":"input",this.listen(this._listenerType,this._changing),this.isLegacy&&this.addDescent(RangeEmission.ENABLE_POINTER,this._enablePointer.bind(this)),this.change()}_init(){this._pointerId=1,this.request((()=>{this.hasAttribute("min")||this.setAttribute("min",0),this.ascend(RangeEmission.CONSTRAINTS,new RangeConstraints(this.node)),this.ascend(RangeEmission.DISABLED,this.node.disabled)})),this.addDescent(RangeEmission.VALUE2,this.setValue.bind(this))}_enablePointer(e){const t=e===this._pointerId;this._isPointerEnabled!==t&&(this._isPointerEnabled=t,t?this.style.removeProperty("pointer-events"):this.style.setProperty("pointer-events","none"))}setValue(e){parseFloat(this.node.value)>e&&(this.node.value=e,this.dispatch("change",void 0,!0),this.change())}change(){this.ascend(RangeEmission.VALUE,parseFloat(this.node.value))}mutate(e){e.includes("disabled")&&this.ascend(RangeEmission.DISABLED,this.node.disabled),(e.includes("min")||e.includes("max")||e.includes("step"))&&(this.ascend(RangeEmission.CONSTRAINTS,new RangeConstraints(this.node)),this.change())}dispose(){this._listenerType&&this.unlisten(this._listenerType,this._changing)}}class RangeInput2 extends RangeInput{static get instanceClassName(){return"RangeInput2"}_init(){this._pointerId=2,this.addDescent(RangeEmission.CONSTRAINTS,this.setConstraints.bind(this)),this.addDescent(RangeEmission.VALUE,this.setValue.bind(this))}setValue(e){parseFloat(this.node.value)<e&&(this.node.value=e,this.dispatch("change",void 0,!0),this.change())}change(){this.ascend(RangeEmission.VALUE2,parseFloat(this.node.value))}setConstraints(e){this.node.min=e.min,this.node.max=e.max,this.node.step=e.step,this.change()}mutate(e){}}class RangeOutput extends api.core.Instance{static get instanceClassName(){return"RangeOutput"}init(){this.addDescent(RangeEmission.OUTPUT,this.change.bind(this))}change(e){this.node.innerText=e.text,this.node.style.transform=e.transform}}class RangeLimit extends api.core.Instance{static get instanceClassName(){return"RangeLimit"}init(){switch(!0){case this.matches(RangeSelector.RANGE_MIN):this.addDescent(RangeEmission.MIN,this.change.bind(this));break;case this.matches(RangeSelector.RANGE_MAX):this.addDescent(RangeEmission.MAX,this.change.bind(this))}}change(e){this.node.innerText=e}}api.range={Range:Range,RangeInput:RangeInput,RangeInput2:RangeInput2,RangeOutput:RangeOutput,RangeLimit:RangeLimit,RangeEmission:RangeEmission,RangeSelector:RangeSelector},api.internals.register(api.range.RangeSelector.RANGE,api.range.Range),api.internals.register(api.range.RangeSelector.RANGE_INPUT,api.range.RangeInput),api.internals.register(api.range.RangeSelector.RANGE_INPUT2,api.range.RangeInput2),api.internals.register(api.range.RangeSelector.RANGE_OUTPUT,api.range.RangeOutput),api.internals.register(api.range.RangeSelector.RANGE_MIN,api.range.RangeLimit),api.internals.register(api.range.RangeSelector.RANGE_MAX,api.range.RangeLimit);